<section class="centred-layout anime-zoom-in" *ngIf="user$ | async as user">
  <form enctype="multipart/form-data" [formGroup]="formGroup">
    <button
      mat-raised-button
      matTooltip="Click or drag here your image to set your avatar"
      i18n-matTooltip
      matTooltipPosition="above"
      class="upload-image-container"
      (drop)="onImportImage($event)"
      (dragover)="(false)"
      (dragend)="(false)"
      (click)="file.click()"
    >
      <input
        #file
        type="file"
        accept="image/*"
        (change)="onImportImage($event)"
      />
      <img
        src="{{ user?.avatar }}"
        i18n-alt="@@your-avatar"
        alt="your avatar"
        default="profile"
      />
    </button>

    <mat-card class="card" [ngClass]="{ 'anime-wobble': errorMessage }">
      <mat-card-header>
        <mat-card-title i18n>Your informations</mat-card-title>
      </mat-card-header>

      <mat-card-content>
        <mat-divider></mat-divider>

        <mat-form-field appearance="outline" color="accent">
          <mat-label i18n="@@your-username">Your username</mat-label>
          <input matInput disabled [value]="user?.username" />
        </mat-form-field>

        <mat-form-field appearance="outline" color="accent">
          <mat-label i18n="@@your-email">Your email</mat-label>
          <input matInput disabled [value]="user?.email" />
        </mat-form-field>

        <mat-form-field appearance="outline" color="accent">
          <mat-label i18n="@@your-description">Your description</mat-label>
          <textarea
            matInput
            cdkTextareaAutosize
            formControlName="description"
            [value]="user?.description"
            autofocus
          ></textarea>
          <mat-hint>{{ description?.value?.length }} / 190</mat-hint>
          <mat-error
            *ngIf="description?.touched && description?.errors?.required"
          ></mat-error
        ></mat-form-field>

        <mat-divider></mat-divider>

        <div class="button-group">
          <button
            mat-raised-button
            color="accent"
            type="submit"
            [disabled]="!formGroup.valid"
            class="btn-submit"
            i18n="@@submit"
          >
            Submit
          </button>
        </div>

        <mat-error *ngIf="errorMessage" class="submit-error">
          {{ errorMessage | json }}
        </mat-error>
      </mat-card-content>
    </mat-card>
  </form>
</section>
